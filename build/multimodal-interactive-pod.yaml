apiVersion: v1
kind: Pod
metadata:
  labels:
    project: multimodal
    user: howard
  name: howard-multimodal-interactive-pod
  namespace: spatiotemporal-decision-making
spec:
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: kubernetes.io/hostname
            operator: In
            values:
            - ry-gpu-03.sdsc.optiputer.net
          - key: nvidia.com/gpu.product
            operator: In
            values:
            - NVIDIA-GeForce-RTX-3090
            - NVIDIA-A10
  containers:
  - command:
    - conda
    - run
    - -n
    - multimodal
    - /bin/bash
    - -c
    - echo IyEvYmluL2Jhc2gKbWtkaXIgLXAgY29uZmlnCnNzaC1rZXlzY2FuIGdpdGh1Yi5jb20gPj4gL3Jvb3QvLnNzaC9rbm93bl9ob3N0cwpzc2gta2V5c2NhbiAtdCBlY2RzYSAtcCAzMDYyMiAtSCBnaXRsYWItc3NoLm5ycC1uYXV0aWx1cy5pbyA+PiAvcm9vdC8uc3NoL2tub3duX2hvc3RzCmdpdCBwdWxsCmdpdCBzdWJtb2R1bGUgdXBkYXRlIC0taW5pdCAtLXJlY3Vyc2l2ZQplY2hvICJjb25kYSBhY3RpdmF0ZSBtdWx0aW1vZGFsOyBzb3VyY2Ugc3JjL3Rvb2xib3gvczNyZWdpb24uc2giID4+IH4vLmJhc2hyYwpleHBvcnQgUEFUSD0iL29wdC9jb25kYS9lbnZzL211bHRpbW9kYWwvYmluLzokUEFUSCIKY2htb2QgK3ggc3JjL3Rvb2xib3gvczNyZWdpb24uc2gKc291cmNlIHNyYy90b29sYm94L3MzcmVnaW9uLnNoCmVjaG8gJ0l5QlRNMTlDVlVOTFJWUmZUa0ZOUlQxdE1tWnZjbVZqWVhOMENpTWdRVmRUWDBGRFEwVlRVMTlMUlZsZlNVUTlSMk5QUW5wek4wUTJPVXBoYTJ0NlFrSklSRzBLSXlCQlYxTmZVMFZEVWtWVVgwRkRRMFZUVTE5TFJWazlRVFJ0ZW0xdFVucElWMkYzV1RsRE9YWTFhVlZOVVZscFYzQkZXV0p1UVZCV1pFZ3hTVkozU0FwVE0xOUZUa1JRVDBsT1ZGOVZVa3c5YUhSMGNITTZMeTl6TXkxM1pYTjBMbTV5Y0MxdVlYVjBhV3gxY3k1cGJ3cElSbDlVVDB0RlRqMW9abDlqYUVsVGFGVnpiRTFJV0dadFJrMTRkVzVIV1hsa1JuVkZjRVZSZDFGamFrUk9DbGRCVGtSQ1gwRlFTVjlMUlZrOWJHOWpZV3d0WVRVME1UZGpNbVUxWVRkaVpqazNZek5rWWpVeU1UWTNZMkkwTlRKbVkySTBZbVExWTJJek5nb2pJRmRCVGtSQ1gwRlFTVjlMUlZrOU9UQmtZemhqTkRBNE9XTXlNVE0yT0dJMk1XWTJaREl3Tmpsa016Z3lNalJrTWpNMk5HTm1Od3BIU1ZSZlZWTkZVazVCVFVVOWFHOTNZWEprT0RneE1ERXdDa2RKVkY5UVFWTlRWMDlTUkQxbmFIQmZlVk5PYXpkeVVFdG9RM2hsTUhwdFluZE1lakl3V1dsMGRXaG5ha041TkRVNGNGUlVDa0ZYVTE5QlEwTkZVMU5mUzBWWlgwbEVQVGcwTmt4U05VaEVNekV6UTAwNVRrMDBOa296Q2tGWFUxOVRSVU5TUlZSZlFVTkRSVk5UWDB0RldUMU1VVXhzVVVkeFdrZzFia2xEU2tkUlZUbENURkoyVDB4TWJVbDJUVTVCWjNWU1ZHUnVWRlV3Q2c9PScgfCBiYXNlNjQgLWQgfCB0ciAtZCAnXHInID4gJy5lbnYnICYmIGVjaG8gPj4gJy5lbnYnIAplY2hvICdjSEp2YW1WamRGOXVZVzFsT2lCdGRXeDBhVzF2WkdGc0NtNWhiV1Z6Y0dGalpUb2djM0JoZEdsdmRHVnRjRzl5WVd3dFpHVmphWE5wYjI0dGJXRnJhVzVuQ25WelpYSTZJR2h2ZDJGeVpBcHlaV2RwYzNSeWVWOW9iM04wT2lCbmFYUnNZV0l0Y21WbmFYTjBjbmt1Ym5Kd0xXNWhkWFJwYkhWekxtbHZDbk56YUY5b2IzTjBPaUJuYVhSc1lXSXRjM05vTG01eWNDMXVZWFYwYVd4MWN5NXBid3B6YzJoZmNHOXlkRG9nTXpBMk1qSUtZMjl1WkdGZmFHOXRaVG9nTDI5d2RDOWpiMjVrWVFwcGJXRm5aVG9nWjJsMGJHRmlMWEpsWjJsemRISjVMbTV5Y0MxdVlYVjBhV3gxY3k1cGJ5OW9iM2RoY21RdmJYVnNkR2x0YjJSaGJEcHNZWFJsYzNRS1ozQjFYM2RvYVhSbGJHbHpkRG9LSUNBdElFNVdTVVJKUVMxSFpVWnZjbU5sTFZKVVdDMHpNRGt3Q2lBZ0xTQk9Wa2xFU1VFdFFURXcnIHwgYmFzZTY0IC1kIHwgdHIgLWQgJ1xyJyA+ICdjb25maWcva3ViZS55YW1sJyAmJiBlY2hvID4+ICdjb25maWcva3ViZS55YW1sJyAKZWNobyAnY0hKdmFtVmpkRjl1WVcxbE9pQnRkV3gwYVcxdlpHRnNDbTF2WkdWc09nb2dJRzFwYzNSeVlXdzNZam9LSUNBZ0lHTnZiVzFoYm1RNklENEtJQ0FnSUNBZ2NIbDBhRzl1SUMxdElHRjRiMnh2ZEd3dVkyeHBMbkJ5WlhCeWIyTmxjM01nWm1sdVpYUjFibVV2WTJ4cGJXRjBaUzU1Yld3Z0ppWUtJQ0FnSUNBZ1lXTmpaV3hsY21GMFpTQnNZWFZ1WTJnZ0xXMGdZWGh2Ykc5MGJDNWpiR2t1ZEhKaGFXNGdabWx1WlhSMWJtVXZZMnhwYldGMFpTNTViV3dnSmlZZ0NpQWdJQ0FnSUhNMVkyMWtJR053SUMxeUlHWnBibVYwZFc1bEwyOTFkSEIxZEhNdlkyeHBiV0YwWlMxbWFXNWxkSFZ1WlNCek16b3ZMMjExYkhScGJXOWtZV3hmWm1sdVpWOTBkVzVwYm1jS0lDQWdJR053ZFY5amIzVnVkRG9nTlFvZ0lDQWdaM0IxWDJOdmRXNTBPaUEwQ2lBZ0lDQnRaVzF2Y25rNklESXdDbVJoZEdGelpYUTZDaUFnZVdWc2NEb0tJQ0FnSUdod1lYSmhiVG9LSUNBZ0lDQWdYMlp1T2lCSWIzZGhjbVE0T0RFd01UQXZXV1ZzY0Mxa1lYUmhjMlYwQ2lBZ2JXbHRhV002Q2lBZ0lDQm9jR0Z5WVcwNkNpQWdJQ0FnSUY5bWJqb2diV2x0YVdNdWRIaDBDbkoxYmpvS0lDQnRiMlJsYkRvZ1cyMXBjM1J5WVd3M1lsMEtJQ0JrWVhSaGMyVjBPaUJiZVdWc2NGMEtJeUJtYVd4bE9nb2pJQ0FnTFNBdUwyRjRiMnh2ZEd3dlpYaGhiWEJzWlhNdmJHeGhiV0V0TWk5dGVXTnZibVpwWnk1NWJXd0thRzl6ZEc1aGJXVmZkMmhwZEdWc2FYTjBPZ29nSUMwZ2Nua3RaM0IxTFRBekxuTmtjMk11YjNCMGFYQjFkR1Z5TG01bGRBbz0nIHwgYmFzZTY0IC1kIHwgdHIgLWQgJ1xyJyA+ICdjb25maWcvbGF1bmNoLnlhbWwnICYmIGVjaG8gPj4gJ2NvbmZpZy9sYXVuY2gueWFtbCcgCmVjaG8gJ2NISnZhbVZqZEY5dVlXMWxPaUJ0ZFd4MGFXMXZaR0ZzQ201aGJXVnpjR0ZqWlRvZ2MzQmhkR2x2ZEdWdGNHOXlZV3d0WkdWamFYTnBiMjR0YldGcmFXNW5DblZ6WlhJNklHaHZkMkZ5WkFweVpXZHBjM1J5ZVY5b2IzTjBPaUJuYVhSc1lXSXRjbVZuYVhOMGNua3Vibkp3TFc1aGRYUnBiSFZ6TG1sdkNuTnphRjlvYjNOME9pQm5hWFJzWVdJdGMzTm9MbTV5Y0MxdVlYVjBhV3gxY3k1cGJ3cHpjMmhmY0c5eWREb2dNekEyTWpJS1kyOXVaR0ZmYUc5dFpUb2dMMjl3ZEM5amIyNWtZUXBwYldGblpUb2daMmwwYkdGaUxYSmxaMmx6ZEhKNUxtNXljQzF1WVhWMGFXeDFjeTVwYnk5b2IzZGhjbVF2YlhWc2RHbHRiMlJoYkRwc1lYUmxjM1FLWjNCMVgzZG9hWFJsYkdsemREb0tJQ0F0SUU1V1NVUkpRUzFIWlVadmNtTmxMVkpVV0Mwek1Ea3dDaUFnTFNCT1ZrbEVTVUV0UVRFdycgfCBiYXNlNjQgLWQgfCB0ciAtZCAnXHInID4gJ2NvbmZpZy9rdWJlLnlhbWwnICYmIGVjaG8gPj4gJ2NvbmZpZy9rdWJlLnlhbWwnIA==
      | base64 -d > startup.sh && chmod +x startup.sh && source startup.sh; sleep
      infinity
    env:
    - name: PYTHONUNBUFFERED
      value: '1'
    - name: PYTHONIOENCODING
      value: UTF-8
    - name: NODE_NAME
      valueFrom:
        fieldRef:
          fieldPath: spec.nodeName
    - name: S3_ENDPOINT_URL
      value: http://rook-ceph-rgw-nautiluss3.rook
    - name: HF_TOKEN
      value: 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
    - name: WANDB_API_KEY
      value: local-a5417c2e5a7bf97c3db52167cb452fcb4bd5cb36
    - name: GIT_USERNAME
      value: howard881010
    - name: GIT_PASSWORD
      value: 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
    - name: AWS_ACCESS_KEY_ID
      value: 846LR5HD313CM9NM46J3
    - name: AWS_SECRET_ACCESS_KEY
      value: LQLlQGqZH5nICJGQU9BLRvOLLmIvMNAguRTdnTU0
    - name: PYTHONPATH
      value: src
    image: gitlab-registry.nrp-nautilus.io/howard/multimodal:latest
    name: gpu-container
    resources:
      limits:
        cpu: '5'
        memory: 32G
        nvidia.com/gpu: '1'
      requests:
        cpu: '5'
        memory: 32G
        nvidia.com/gpu: '1'
    volumeMounts:
    - mountPath: /dev/shm
      name: dshm
  imagePullSecrets:
  - name: multimodal-read-registry
  restartPolicy: Never
  tolerations: []
  volumes:
  - emptyDir:
      medium: Memory
    name: dshm
