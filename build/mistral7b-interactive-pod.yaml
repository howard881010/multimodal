apiVersion: v1
kind: Pod
metadata:
  labels:
    project: example
    user: howard
  name: howard-mistral7b-interactive-pod
  namespace: spatiotemporal-decision-making
spec:
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: nvidia.com/gpu.product
            operator: In
            values:
            - NVIDIA-GeForce-RTX-3090
            - NVIDIA-A10
  containers:
  - command:
    - conda
    - run
    - -n
    - example
    - /bin/bash
    - -c
    - echo IyEvYmluL2Jhc2gKbWtkaXIgLXAgY29uZmlnCnNzaC1rZXlzY2FuIGdpdGh1Yi5jb20gPj4gL3Jvb3QvLnNzaC9rbm93bl9ob3N0cwpzc2gta2V5c2NhbiAtdCBlY2RzYSAtcCAzMDYyMiAtSCBnaXRsYWItc3NoLm5ycC1uYXV0aWx1cy5pbyA+PiAvcm9vdC8uc3NoL2tub3duX2hvc3RzCmdpdCBwdWxsCmdpdCBzdWJtb2R1bGUgdXBkYXRlIC0taW5pdCAtLXJlY3Vyc2l2ZQplY2hvICJjb25kYSBhY3RpdmF0ZSBleGFtcGxlOyBzb3VyY2Ugc3JjL3Rvb2xib3gvczNyZWdpb24uc2giID4+IH4vLmJhc2hyYwpleHBvcnQgUEFUSD0iL29wdC9jb25kYS9lbnZzL2V4YW1wbGUvYmluLzokUEFUSCIKY2htb2QgK3ggc3JjL3Rvb2xib3gvczNyZWdpb24uc2gKc291cmNlIHNyYy90b29sYm94L3MzcmVnaW9uLnNoCmVjaG8gJ1V6TmZRbFZEUzBWVVgwNUJUVVU5YlRKbWIzSmxZMkZ6ZEFwQlYxTmZRVU5EUlZOVFgwdEZXVjlKUkQxeFZGQjRiVlJRZGxCSlJWWk9OMnhrY1ZSc053cEJWMU5mVTBWRFVrVlVYMEZEUTBWVFUxOUxSVms5YkhWNWJHSnpVRTlVYjJGQ1VESkJlbVIzY0dVM1ZFOW1VR3BVVm1wSFJrVkZPVzA1UWxJemVRcFRNMTlGVGtSUVQwbE9WRjlWVWt3OWFIUjBjSE02THk5eWIzTmxaR0YwWVM1MVkzTmtMbVZrZFE9PScgfCBiYXNlNjQgLWQgfCB0ciAtZCAnXHInID4gJy5lbnYnICYmIGVjaG8gPj4gJy5lbnYnIAplY2hvICdjSEp2YW1WamRGOXVZVzFsT2lCdGFYTjBjbUZzTjJJS2JtRnRaWE53WVdObE9pQnpjR0YwYVc5MFpXMXdiM0poYkMxa1pXTnBjMmx2YmkxdFlXdHBibWNLZFhObGNqb2dhRzkzWVhKa0NuSmxaMmx6ZEhKNVgyaHZjM1E2SUdkcGRHeGhZaTF5WldkcGMzUnllUzV1Y25BdGJtRjFkR2xzZFhNdWFXOEtjM05vWDJodmMzUTZJR2RwZEd4aFlpMXpjMmd1Ym5Kd0xXNWhkWFJwYkhWekxtbHZDbk56YUY5d2IzSjBPaUF6TURZeU1ncGpiMjVrWVY5b2IyMWxPaUF2YjNCMEwyTnZibVJoQ21sdFlXZGxPaUJuYVhSc1lXSXRjbVZuYVhOMGNua3Vibkp3TFc1aGRYUnBiSFZ6TG1sdkwyaHZkMkZ5WkM5dGFYTjBjbUZzTjJJNmJHRjBaWE4wQ21kd2RWOTNhR2wwWld4cGMzUTZDaUFnTFNCT1ZrbEVTVUV0UjJWR2IzSmpaUzFTVkZndE16QTVNQW9nSUMwZ1RsWkpSRWxCTFVFeE1BPT0nIHwgYmFzZTY0IC1kIHwgdHIgLWQgJ1xyJyA+ICdjb25maWcva3ViZS55YW1sJyAmJiBlY2hvID4+ICdjb25maWcva3ViZS55YW1sJyAKZWNobyAnY0hKdmFtVmpkRjl1WVcxbE9pQmxlR0Z0Y0d4bENtMXZaR1ZzT2dvZ0lHRjJaWEpoWjJVNkNpQWdJQ0FqSUR4bWJqNGdkMmxzYkNCaVpTQmhkWFJ2YldGMGFXTmhiR3g1SUhKbGNHeGhZMlZrSUdKNUlHaHdZWEpoYlNCMllXeDFaWE1LSUNBZ0lHTnZiVzFoYm1RNklENHRDaUFnSUNBZ0lGdGRLRzFoYTJVZ1pHOTNibXh2WVdRZ1ptbHNaVDFrWVhSaEx6c3BJSEI1ZEdodmJpQnpjbU12WVhabkxuQjVJRHhtYmo0S0lDQWdJQ01nSXlCTmIyUmxiQ0JqWVc0Z1lXeHpieUJvWVhabElHaHdZWEpoYlN3Z2FIQmhjbUZ0SUdOdmRXeGtJR0psSUdWcGRHaGxjaUJzYVhOMElHOXlJSE5wYm1kc1pTQjJZV3gxWlFvZ0lDQWdJeUJvY0dGeVlXMDZDaUFnSUNBaklDQWdhR2xrWDJScGJUb2dXekkxTml3Z05URXlYUW9nSUNBZ0l5QWdJQzR1TGdvZ0lDQWdJeUFqSUU5MlpYSnlhV1JsSUNwdWIyNHRjSEp2YW1WamRIZHBjMlVxSUd0MVltVWdZMjl1Wm1sbkxDQnpaV1VnVTJWamRHbHZiaUF5Q2lBZ0lDQm5jSFZmWTI5MWJuUTZJREFLSUNBZ0lDTWdiV1Z0YjNKNU9pQTRJQ0FqSURoSGFVSUtJQ0FnSUNNZ2FXMWhaMlU2SUdkcGRHeGhZaTF5WldkcGMzUnllUzV1Y25BdGJtRjFkR2xzZFhNdWFXOHZjSEp3TDJwMWNIbDBaWEl0YzNSaFkyc3ZiV2x1YVcxaGJBb2dJQ0FnSXlBdUxpNEtJQ0J0WldScFlXNDZDaUFnSUNCamIyMXRZVzVrT2lBK0xRb2dJQ0FnSUNCYlhTaHRZV3RsSUdSdmQyNXNiMkZrSUdacGJHVTlaR0YwWVM4N0tTQndlWFJvYjI0Z2MzSmpMMjFsWkM1d2VTQThabTQrQ2lBZ0lDQm5jSFZmWTI5MWJuUTZJREFLWkdGMFlYTmxkRG9LSUNCa1lYUmhNVG9LSUNBZ0lHaHdZWEpoYlRvS0lDQWdJQ0FnSXlCTVlYVnVZMmdnZDJsc2JDQmhkWFJ2YldGMGFXTmhiR3g1SUdOdmJuTnBaR1Z5SUdGc2JDQmpiMjFpYVc1aGRHbHZibk1nYjJZZ2FIQmhjbUZ0Q2lBZ0lDQWdJQ01nYUhCaGNtRnRJSEJ5WldObFpHVmtJR0o1SUY4Z2QybHNiQ0JPVDFRZ1lYQndaV0Z5SUdsdUlIUm9aU0JxYjJJZ2JtRnRaUW9nSUNBZ0lDQWpJRWxtSUhsdmRYSWdhSEJoY21GdElHTnZiblJoYVc0Z2MzQmxZMmxoYkNCamFHRnlZV04wWlhKekxDQjViM1VnYlhWemRDQmZJSFJvWlcwS0lDQWdJQ0FnWDJadU9pQmtZWFJoTHpFdWRIaDBDaUFnWkdGMFlUSTZDaUFnSUNCb2NHRnlZVzA2Q2lBZ0lDQWdJRjltYmpvZ1pHRjBZUzh5TG5SNGRBcHlkVzQ2Q2lBZ1pHRjBZWE5sZERvZ1cyUmhkR0V4WFFvZ0lHMXZaR1ZzT2lCYllYWmxjbUZuWlYwPScgfCBiYXNlNjQgLWQgfCB0ciAtZCAnXHInID4gJ2NvbmZpZy9sYXVuY2gueWFtbCcgJiYgZWNobyA+PiAnY29uZmlnL2xhdW5jaC55YW1sJyAKZWNobyAnY0hKdmFtVmpkRjl1WVcxbE9pQnRhWE4wY21Gc04ySUtibUZ0WlhOd1lXTmxPaUJ6Y0dGMGFXOTBaVzF3YjNKaGJDMWtaV05wYzJsdmJpMXRZV3RwYm1jS2RYTmxjam9nYUc5M1lYSmtDbkpsWjJsemRISjVYMmh2YzNRNklHZHBkR3hoWWkxeVpXZHBjM1J5ZVM1dWNuQXRibUYxZEdsc2RYTXVhVzhLYzNOb1gyaHZjM1E2SUdkcGRHeGhZaTF6YzJndWJuSndMVzVoZFhScGJIVnpMbWx2Q25OemFGOXdiM0owT2lBek1EWXlNZ3BqYjI1a1lWOW9iMjFsT2lBdmIzQjBMMk52Ym1SaENtbHRZV2RsT2lCbmFYUnNZV0l0Y21WbmFYTjBjbmt1Ym5Kd0xXNWhkWFJwYkhWekxtbHZMMmh2ZDJGeVpDOXRhWE4wY21Gc04ySTZiR0YwWlhOMENtZHdkVjkzYUdsMFpXeHBjM1E2Q2lBZ0xTQk9Wa2xFU1VFdFIyVkdiM0pqWlMxU1ZGZ3RNekE1TUFvZ0lDMGdUbFpKUkVsQkxVRXhNQT09JyB8IGJhc2U2NCAtZCB8IHRyIC1kICdccicgPiAnY29uZmlnL2t1YmUueWFtbCcgJiYgZWNobyA+PiAnY29uZmlnL2t1YmUueWFtbCcg
      | base64 -d > startup.sh && chmod +x startup.sh && source startup.sh; sleep
      infinity
    env:
    - name: PYTHONUNBUFFERED
      value: '1'
    - name: PYTHONIOENCODING
      value: UTF-8
    - name: NODE_NAME
      valueFrom:
        fieldRef:
          fieldPath: spec.nodeName
    - name: S3_BUCKET_NAME
      value: m2forecast
    - name: AWS_ACCESS_KEY_ID
      value: qTPxmTPvPIEVN7ldqTl7
    - name: AWS_SECRET_ACCESS_KEY
      value: luylbsPOToaBP2Azdwpe7TOfPjTVjGFEE9m9BR3y
    - name: S3_ENDPOINT_URL
      value: https://rosedata.ucsd.edu
    - name: PYTHONPATH
      value: src
    image: gitlab-registry.nrp-nautilus.io/howard/mistral7b:latest
    name: gpu-container
    resources:
      limits:
        cpu: '0'
        memory: 0G
        nvidia.com/gpu: '1'
      requests:
        cpu: '0'
        memory: 0G
        nvidia.com/gpu: '1'
    volumeMounts:
    - mountPath: /dev/shm
      name: dshm
  imagePullSecrets:
  - name: example-read-registry
  restartPolicy: Never
  tolerations: []
  volumes:
  - emptyDir:
      medium: Memory
    name: dshm
